## ADDED Requirements

### Requirement: 统一数据库连接环境变量解析

应用程序 **MUST** 使用一致的环境变量优先级来解析数据库连接字符串。

#### Scenario: 应用程序启动时解析环境变量

当应用程序启动时，系统必须按照以下优先级顺序解析数据库连接字符串：

1. `DATABASE_URL`（最高优先级）
2. `POSTGRES_URL`（备选项）
3. `POSTGRES_URL_NON_POOLING`（最后备选）

### Requirement: 修复健康检查数据库连接验证

健康检查 API **MUST** 正确验证数据库连接状态并报告详细的健康信息。

#### Scenario: 健康检查 API 被调用

当客户端调用 `/api/health` 端点时，系统必须：

- 使用与数据库服务相同的环境变量解析逻辑
- 执行实际的数据库连接测试
- 提供准确的服务状态（ok/error/not_configured）
- 包含连接延迟信息（当连接成功时）
- 不暴露敏感的连接信息

### Requirement: 数据库连接启动验证

应用程序 **MUST** 在启动时验证数据库连接的可用性，并在连接失败时提供明确的错误信息。

#### Scenario: 应用程序启动

当 Next.js 应用程序启动时，系统必须：

- 在后台验证数据库连接
- 如果连接失败，记录详细的错误日志
- 应用程序继续启动，但标记数据库状态为不可用
- 在健康检查中反映真实状态

### Requirement: 环境变量配置管理

环境变量文件 **MUST** 提供一致的数据库配置选项。

#### Scenario: 开发者配置数据库连接

开发者在设置本地开发环境时，必须能够：

- 使用标准的 `DATABASE_URL` 环境变量
- 继续使用现有的 `POSTGRES_URL` 作为备选项
- 在 `.env.example` 文件中找到清晰的配置示例
