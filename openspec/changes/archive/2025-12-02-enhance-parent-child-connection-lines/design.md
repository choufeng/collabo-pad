## Context

当前系统已具备基础的连接线功能，在 `topic-to-node.ts` 中实现了基于 parent_id 的简单连接线生成。但现有实现在视觉表现、交互功能和性能优化方面存在不足，需要进一步增强以满足用户对清晰层级关系可视化的需求。

## Goals / Non-Goals

### Goals

- 提供清晰美观的层级关系连接线可视化
- 实现基本的连接线路径规划，避免明显重叠
- 提供简洁的连接线样式系统

### Non-Goals

- 复杂的连接线交互功能（悬停、点击、右键菜单等）
- 高性能优化（虚拟化渲染、LOD系统等）
- 复杂的连接线编辑功能
- 动画效果和高级样式配置

## Decisions

### 连接线渲染技术选择

- **决策：** 继续使用 ReactFlow 的内置 Edge 系统
- **理由：** ReactFlow 已提供成熟的连接线渲染和交互功能，无需重复造轮子
- **替代方案：** 自定义 SVG 渲染系统（复杂度高，维护成本大）

### 连接线样式实现

- **决策：** 使用 ReactFlow 的自定义 Edge 类型
- **理由：** 灵活性高，可以实现复杂的视觉效果和交互
- **替代方案：** 仅使用内置样式（功能有限，无法满足定制需求）

### 性能优化策略

- **决策：** 实现连接线级别的虚拟化和LOD系统
- **理由：** 在大量节点场景下保持良好的性能表现
- **替代方案：** 简单的显示/隐藏逻辑（无法精细控制性能）

## Risks / Trade-offs

### 兼容性风险

- **风险：** 新的连接线功能可能与现有节点系统不兼容
- **缓解：** 保持向后兼容，新功能作为现有逻辑的增强

### 简洁性 vs 功能性

- **风险：** 功能过于简单可能无法满足某些需求
- **缓解：** 专注核心需求，保持连接线功能简洁实用

## Migration Plan

### 阶段1：基础功能增强

1. 扩展现有 `topic-to-node.ts` 的连接线生成逻辑
2. 实现基础的连接线样式改进
3. 添加基本的路径优化
4. 确保与现有系统的兼容性

### 阶段2：测试和验证

1. 编写连接线相关的测试
2. 验证不同场景下的连接线显示效果
3. 完善文档

## Open Questions

- 连接线样式是否需要支持主题切换？
- 是否需要支持连接线的分组显示？
- 如何处理深层级节点的连接线显示问题？
- 连接线配置是否需要保存到用户偏好设置中？
