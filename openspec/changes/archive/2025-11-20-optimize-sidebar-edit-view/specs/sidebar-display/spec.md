# 侧边栏编辑模式优化 Specification

## Purpose

将右侧边栏的编辑模式优化为只读显示模式，提供更好的主题详情查看体验，同时保持数据一致性和功能完整性。

## Requirements

## ADDED

### Requirement: 主题详情只读显示

系统 SHALL 在编辑模式下提供主题的只读详细信息显示。

#### Scenario: 基本主题信息显示

- **WHEN** 用户点击节点打开侧边栏时
- **THEN** 系统必须显示主题的完整内容
- **AND** 必须显示主题创建者的用户名
- **AND** 必须显示主题的创建时间
- **AND** 必须显示主题的层级信息
- **AND** 内容区域必须支持长文本和换行显示

#### Scenario: 元数据信息展示

- **WHEN** 显示主题详情时
- **THEN** 系统必须显示主题的元数据信息
- **AND** 必须显示主题的标签信息（如果有）
- **AND** 必须显示主题的父节点关系（如果有）
- **AND** 必须显示主题的子节点数量
- **AND** 元数据信息必须格式化显示以提高可读性

## MODIFIED

### Requirement: 侧边栏模式功能优化

侧边栏系统 SHALL 区分不同模式的功能并提供相应的界面。

#### Scenario: 编辑模式转换为查看模式

- **WHEN** 侧边栏处于编辑模式时
- **THEN** 标题必须显示为"Topic Details"
- **AND** 图标必须为查看/信息图标而非编辑图标
- **AND** 必须移除所有编辑相关的表单元素
- **AND** 必须移除保存和提交按钮
- **AND** 界面布局必须优化为信息展示而非输入

#### Scenario: 其他模式功能保持

- **WHEN** 侧边栏处于创建模式时
- **THEN** 创建表单功能必须完全保持不变
- **AND** 验证逻辑必须正常工作
- **AND** 提交按钮必须正常显示和功能

- **WHEN** 侧边栏处于子评论模式时
- **THEN** 子主题创建功能必须完全保持不变
- **AND** 父节点信息显示必须正常工作
- **AND** 创建流程必须保持一致

## ADDED

### Requirement: 内容格式化和可读性

系统 SHALL 提供良好的内容格式化和可读性体验。

#### Scenario: 长文本内容显示

- **WHEN** 主题内容较长时
- **THEN** 内容区域必须支持垂直滚动
- **AND** 必须保持原始的换行和段落格式
- **AND** 文字大小和行间距必须优化阅读体验
- **AND** 内容区域必须有合适的最大宽度和高度

#### Scenario: 响应式布局支持

- **WHEN** 在不同屏幕尺寸下查看主题详情时
- **THEN** 布局必须适配移动设备
- **AND** 文字大小必须在移动设备上保持可读性
- **AND** 滚动行为必须在触摸设备上正常工作
- **AND** 信息层次必须在小屏幕上保持清晰

## ADDED

### Requirement: 可访问性支持

系统 SHALL 确保主题详情显示满足可访问性要求。

#### Scenario: 键盘导航支持

- **WHEN** 使用键盘导航时
- **THEN** 关闭按钮必须可以通过键盘访问
- **AND** 子主题创建功能必须支持键盘操作
- **AND** 焦点管理必须符合WCAG标准
- **AND** 屏幕阅读器必须能正确读取所有信息

#### Scenario: 屏幕阅读器支持

- **WHEN** 屏幕阅读器用户访问主题详情时
- **THEN** 所有信息必须有适当的aria标签
- **AND** 信息结构必须逻辑清晰
- **AND** 用户名和内容必须明确区分
- **AND** 元数据信息必须有适当的描述

## MODIFIED

### Requirement: 类型安全和数据一致性

系统 SHALL 确保类型定义与新的显示逻辑保持一致。

#### Scenario: 接口类型更新

- **WHEN** 定义组件接口时
- **THEN** NodeData接口必须支持显示所需的字段
- **AND** TopicNodeData接口必须包含用户信息字段
- **AND** 类型定义必须与实际数据结构匹配
- **AND** TypeScript类型检查必须通过

#### Scenario: 数据一致性保证

- **WHEN** 显示主题信息时
- **THEN** 显示的数据必须与SSE数据源保持一致
- **AND** 不得提供任何数据修改功能
- **AND** 显示格式必须统一且可预测
- **AND** 错误处理必须优雅且用户友好
